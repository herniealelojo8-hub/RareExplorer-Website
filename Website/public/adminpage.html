<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rare Explorer ‚Äì Travel Packages</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* -------------------- ORIGINAL PACKAGE STYLES (UNCHANGED) -------------------- */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 15px 30px;
      background: #1e293b;
      border-bottom: 1px solid #334155;
    }
    .logo-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .logo-container img {
      height: 50px;
      width: auto;
      border-radius: 50%;
    }
    .logo-text {
      font-size: 24px;
      font-weight: bold;
    }
    .search-bar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .search-bar input {
      padding: 8px 12px;
      border-radius: 8px;
      border: none;
      outline: none;
      background: #0b1220;
      color: white;
    }
    .btn {
      padding: 8px 14px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-primary {
      background: linear-gradient(to right, #4f46e5, #06b6d4);
      color: white;
    }
    .btn-secondary {
      background: #475569;
      color: white;
    }
    .btn-danger {
      background: #dc2626;
      color: white;
    }
    .container {
      padding: 20px 30px;
    }
    .flex-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-top: 20px;
    }
    @media (max-width: 900px) {
      .card-grid { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 600px) {
      .card-grid { grid-template-columns: 1fr; }
    }
    .card {
      background: #1e293b;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
    }
    .card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }
    .card-content { padding: 15px; }
    .tags {
      display: flex;
      gap: 8px;
      margin: 5px 0;
      flex-wrap: wrap;
    }
    .tag {
      background: #334155;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 12px;
    }
    .card-footer {
      display: flex;
      justify-content: flex-end;
      padding: 10px 15px;
      border-top: 1px solid #334155;
      flex-wrap: wrap;
      gap: 5px;
    }
    /* -------------------- BOOKING TABLE STYLES (NEW, KEPT SEPARATE) -------------------- */
    .table-wrap {
      margin-top: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border: 1px solid rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 12px;
      overflow-x: auto;
      box-shadow: 0 6px 24px rgba(2,6,23,0.6);
    }
    table.bookings {
      width: 100%;
      border-collapse: collapse;
      min-width: 920px;
    }
    table.bookings thead th {
      text-align: left;
      font-size: 13px;
      font-weight: 700;
      padding: 12px 14px;
      color: #cfe8ff;
      background: rgba(255,255,255,0.02);
      border-bottom: 1px solid rgba(255,255,255,0.04);
      position: sticky;
      top: 0;
      z-index: 5;
      backdrop-filter: blur(6px);
    }
    table.bookings tbody tr {
      transition: background .14s ease, transform .06s ease;
      border-bottom: 1px solid rgba(255,255,255,0.02);
    }
    table.bookings tbody tr:hover {
      background: rgba(255,255,255,0.02);
      transform: translateY(-1px);
    }
    table.bookings td {
      padding: 12px 14px;
      vertical-align: middle;
      color: #dbeeff;
      font-size: 14px;
    }
    .pkg-cell {
      display:flex; gap:12px; align-items:center;
    }
    .pkg-thumb {
      width:64px; height:48px; object-fit:cover; border-radius:8px; flex-shrink:0; border:1px solid rgba(255,255,255,0.04);
    }
    .muted { color: #94a3b8; font-size:13px; }
    .actions { display:flex; gap:8px; align-items:center; justify-content:flex-end; }
    .action-btn {
      padding: 8px 10px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      font-weight:700;
      display:inline-flex;
      gap:8px;
      align-items:center;
    }
    .action-view { background: #0b1220; border: 1px solid rgba(79,70,229,0.12); color: #cfe8ff; }
    .action-delete { background: transparent; border: 1px solid rgba(255,255,255,0.06); color: #ffced6; }
    .pill { font-size:12px; padding:6px 8px; border-radius:8px; background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); }
    /* Modal (view) */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.6);
      overflow-y: auto;
      z-index: 1000;
      padding: 24px;
      box-sizing: border-box;
    }
    .modal.show { display: flex; align-items: center; justify-content: center; }
    /* -------------------- RECEIPT / TICKET STYLES -------------------- */
    .modal-card {
      width: 900px;
      max-width: 96%;
      background: linear-gradient(180deg, #0f172a, #071023);
      border-radius: 12px;
      padding: 18px;
      box-shadow: 0 12px 42px rgba(2,6,23,0.7);
      border: 1px solid rgba(255,255,255,0.03);
      position: relative;
    }
    .receipt {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
      border-radius: 10px;
      padding: 16px;
      color: #e6eef8;
    }
    .ticket {
      display: grid;
      grid-template-columns: 1fr 340px;
      gap: 14px;
      align-items: stretch;
    }
    .ticket-left, .ticket-right {
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      padding: 12px;
    }
    .ticket-left { min-height: 260px; }
    .ticket-right { display:flex; flex-direction:column; justify-content:space-between; }
    .receipt .title {
      text-align:center;
      font-size:22px;
      font-weight:800;
      color: #a78bfa;
      letter-spacing: 0.6px;
      margin-bottom:10px;
    }
    .flex-row { display:flex; justify-content:space-between; align-items:center; gap:10px; }
    .small-muted { color:#9aa6bf; font-size:13px; }
    .label { font-size:12px; color:#94a3b8; }
    .value { font-weight:700; font-size:15px; margin-top:4px; }
    .divider-vertical {
      border-left: 2px dashed rgba(255,255,255,0.06);
      margin: 0 8px;
      height: 100%;
    }
    .tear-line {
      border-top: 1px dashed rgba(255,255,255,0.06);
      margin: 12px 0;
    }
    .barcode {
      height: 54px;
      background: repeating-linear-gradient(90deg, #0f172a 0 4px, rgba(255,255,255,0.06) 4px 6px);
      border-radius: 4px;
      margin-top:10px;
    }
    .ticket-meta { display:flex; gap:12px; flex-wrap:wrap; margin-top:8px; }
    .meta-block { min-width:140px; }
    .img-thumb { width:100%; height:110px; object-fit:cover; border-radius:6px; border:1px solid rgba(255,255,255,0.03); }
    .ticket-footer { display:flex; justify-content:space-between; gap:10px; align-items:center; margin-top:12px; }
    .print-btn { padding:8px 12px; border-radius:8px; border:none; cursor:pointer; font-weight:700; }
    .muted-2 { color:#bcd0ea; font-size:13px; }
    @media (max-width: 920px) {
      .ticket { grid-template-columns: 1fr; }
      .receipt .title { font-size:20px; }
    }
  </style>

  <!--  Firebase + Firestore -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import { getFirestore, collection, getDocs, addDoc, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB7PKVUrQcL-pEeOnn9XU9D3tgK90WkSU8",
      authDomain: "travelbook-64c34.firebaseapp.com",
      projectId: "travelbook-64c34",
      storageBucket: "travelbook-64c34.appspot.com",
      messagingSenderId: "964725351972",
      appId: "1:964725351972:web:788b5e8361333723fa5ab1",
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, (user) => {
      if (!user) window.location.href = "UserSignup.html";
    });

    window.logout = function() {
      signOut(auth).then(() => window.location.href = "browsing.html");
    };

    let places = [];
    let bookingsCount = 0;
    let selectedPackage = null;
    let editPackageId = null;
    let bookingsArray = []; // holds receipts loaded from Firestore

    function formatPHP(value) {
      if (isNaN(value)) return "‚Ç±0.00";
      return "‚Ç±" + Number(value).toLocaleString("en-PH", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    /* -------------------- Load packages (unchanged card rendering) -------------------- */
    async function loadPlaces() {
      const querySnapshot = await getDocs(collection(db, "packages"));
      places = [];
      querySnapshot.forEach((d) => places.push({ id: d.id, ...d.data() }));
      renderPlaces();
    }

    window.renderPlaces = function(filtered = places) {
      const list = document.getElementById("placeList");
      list.innerHTML = "";
      filtered.forEach((p, index) => {
        list.innerHTML += `
          <div class="card">
            <img src="${p.img}" alt="${p.name}">
            <div class="card-content">
              <h3>${p.name}</h3>
              <p>${p.city}</p>
              <p><i>${p.duration}</i></p>
              <div class="tags">
                ${p.tags.map(t => `<span class="tag">${t}</span>`).join("")}
              </div>
              <p><b>${formatPHP(p.price)}</b> / person</p>
            </div>
            <div class="card-footer">
              <button class="btn btn-primary" onclick="openPayment(${index})">Book</button>
              <button class="btn btn-secondary" onclick="openEdit(${index})">Edit</button>
              <button class="btn btn-danger" onclick="deletePackage('${p.id}')">Delete</button>
            </div>
          </div>
        `;
      });
      document.getElementById("stats").innerText = `${places.length} packages ¬∑ ${bookingsCount} bookings`;
    };

    window.clearSearch = function() {
      document.getElementById("search").value = "";
      renderPlaces();
    };

    window.searchPlaces = function() {
      const query = document.getElementById("search").value.toLowerCase();
      const filtered = places.filter(p => p.name.toLowerCase().includes(query) || p.city.toLowerCase().includes(query));
      renderPlaces(filtered);
    };

    /* -------------------- Bookings: load and render as table -------------------- */
    async function loadBookings() {
      const querySnapshot = await getDocs(collection(db, "receipts"));
      bookingsArray = [];
      querySnapshot.forEach((d) => bookingsArray.push({ id: d.id, ...d.data() }));
      bookingsCount = bookingsArray.length;
      renderBookings(bookingsArray);
      // update stats
      document.getElementById("stats").innerText = `${places.length} packages ¬∑ ${bookingsCount} bookings`;
    }

    window.renderBookings = function(arr) {
      const tbody = document.getElementById("bookingsBody");
      tbody.innerHTML = "";
      if (!arr || arr.length === 0) {
        tbody.innerHTML = `<tr><td colspan="8" style="padding:28px 14px; text-align:center; color:#94a3b8">No bookings yet.</td></tr>`;
        return;
      }

      arr.forEach((b) => {
        const date = b.date ? new Date(b.date).toLocaleString("en-PH", { dateStyle: "medium", timeStyle: "short" }) : "-";
        const priceStr = (typeof b.price === "number") ? formatPHP(b.price) : (b.price ? formatPHP(Number(b.price)) : "‚Ç±0.00");
        const img = b.packageImage || "Images/logo.jpg";
        tbody.innerHTML += `
          <tr data-id="${b.id}">
            <td>
              <div class="pkg-cell">
                <img class="pkg-thumb" src="${img}" alt="${b.packageName}">
                <div>
                  <div style="font-weight:700">${b.packageName || "-"}</div>
                  <div class="muted" style="margin-top:6px">${b.city || "-"}</div>
                </div>
              </div>
            </td>
            <td>${b.city || "-"}</td>
            <td class="muted">${b.duration || "-"}</td>
            <td style="font-weight:700">${priceStr}</td>
            <td>
              <div style="font-weight:700">${b.payerName || "-"}</div>
              <div class="muted">${b.payerEmail || "-"}</div>
            </td>
            <td>
              <div style="font-weight:700" class="muted">${b.transactionId || "-"}</div>
              <div class="muted" style="margin-top:6px">${date}</div>
            </td>
            <td class="actions">
              <button class="action-btn action-view" onclick="viewBooking('${b.id}')">üîç View</button>
              <button class="action-btn action-delete" onclick="deleteBooking('${b.id}')">üóë Delete</button>
            </td>
          </tr>
        `;
      });
    };

    /* -------------------- View modal (RECEIPT) -------------------- */
    window.viewBooking = function(id) {
      const b = bookingsArray.find(x => x.id === id);
      if (!b) return alert("Booking not found.");
      document.getElementById("viewImg").src = b.packageImage || "Images/logo.jpg";
      document.getElementById("viewPackageName").innerText = b.packageName || "-";
      document.getElementById("viewCity").innerText = b.city || "-";
      document.getElementById("viewDuration").innerText = b.duration || "-";
      document.getElementById("viewPrice").innerText = (typeof b.price === "number") ? formatPHP(b.price) : (b.price ? formatPHP(Number(b.price)) : "‚Ç±0.00");
      document.getElementById("viewPayer").innerText = (b.payerName || "-") + " ¬∑ " + (b.payerEmail || "-");
      document.getElementById("viewTransaction").innerText = b.transactionId || "-";
      document.getElementById("viewDate").innerText = b.date ? new Date(b.date).toLocaleString("en-PH", { dateStyle: "medium", timeStyle: "short" }) : "-";

      // Additional small labels (issuer & agent) - in case you want to set them dynamically later
      document.getElementById("agentName").innerText = "RareExplorer Travel & Tours";
      document.getElementById("issuedBy").innerText = "Phili Airline";

      document.getElementById("viewModal").classList.add("show");
    };

    window.closeViewModal = function() {
      document.getElementById("viewModal").classList.remove("show");
    };

    /* Print only the ticket area */
    window.printTicket = function() {
      const ticketHtml = document.querySelector("#viewModal .receipt").outerHTML;
      const css = `
        body { font-family: Arial, sans-serif; background: white; color: black; padding: 18px; }
        .receipt { background: white; color: black; box-shadow:none; border-radius:4px; }
        .ticket-left, .ticket-right { background: transparent; padding:6px; }
        .barcode { background: repeating-linear-gradient(90deg, #000 0 4px, #fff 4px 6px); height:40px; }
      `;
      const w = window.open("", "_blank", "width=900,height=700");
      w.document.write(`<html><head><title>Receipt - RareExplorer</title><style>${css}</style></head><body>${ticketHtml}</body></html>`);
      w.document.close();
      w.focus();
      // give browser a brief moment to render then print
      setTimeout(() => { w.print(); w.close(); }, 300);
    };

    /* -------------------- Delete booking -------------------- */
    window.deleteBooking = async function(id) {
      if (!confirm("Are you sure you want to permanently delete this booking?")) return;
      try {
        await deleteDoc(doc(db, "receipts", id));
        await loadBookings();
        alert("Booking deleted.");
      } catch (err) {
        console.error(err);
        alert("Failed to delete booking. Check console for details.");
      }
    };

    /* -------------------- Package edit/add (kept) -------------------- */
    window.openEdit = function(index) {
      const p = places[index];
      editPackageId = p.id;
      document.getElementById("editName").value = p.name;
      document.getElementById("editCity").value = p.city;
      document.getElementById("editDuration").value = p.duration;
      document.getElementById("editPrice").value = p.price;
      document.getElementById("editImg").value = p.img;
      document.getElementById("editTags").value = p.tags.join(", ");
      document.getElementById("editModal").style.display = "flex";
    };

    window.saveEdit = async function() {
      if (!editPackageId) return;
      const ref = doc(db, "packages", editPackageId);
      await updateDoc(ref, {
        name: document.getElementById("editName").value,
        city: document.getElementById("editCity").value,
        duration: document.getElementById("editDuration").value,
        price: parseFloat(document.getElementById("editPrice").value),
        img: document.getElementById("editImg").value,
        tags: document.getElementById("editTags").value.split(",").map(t => t.trim())
      });
      document.getElementById("editModal").style.display = "none";
      loadPlaces();
    };

    window.deletePackage = async function(id) {
      if (confirm("Are you sure you want to delete this package?")) {
        await deleteDoc(doc(db, "packages", id));
        loadPlaces();
      }
    };

    window.closeEditModal = function() {
      document.getElementById("editModal").style.display = "none";
    };

    window.openAdd = function() {
      document.getElementById("addModal").style.display = "flex";
    };

    window.saveAdd = async function() {
      const name = document.getElementById("addName").value;
      const city = document.getElementById("addCity").value;
      const duration = document.getElementById("addDuration").value;
      const price = parseFloat(document.getElementById("addPrice").value);
      const img = document.getElementById("addImg").value;
      const tags = document.getElementById("addTags").value.split(",").map(t => t.trim());
      await addDoc(collection(db, "packages"), { name, city, duration, price, img, tags });
      document.getElementById("addModal").style.display = "none";
      loadPlaces();
    };

    window.closeAddModal = function() {
      document.getElementById("addModal").style.display = "none";
    };

    /* -------------------- PayPal (kept) -------------------- */
    window.openPayment = function(index) {
      selectedPackage = places[index];
      document.getElementById("paymentModal").style.display = "flex";

      document.getElementById("paypal-button").innerHTML = "";
      paypal.Buttons({
        createOrder: (data, actions) => actions.order.create({
          purchase_units: [{
            description: selectedPackage.name,
            amount: { value: selectedPackage.price.toString(), currency_code: "PHP" }
          }]
        }),
        onApprove: (data, actions) => actions.order.capture().then(async (details) => {
          bookingsCount++;
          alert(" Payment successful! Thank you " + details.payer.name.given_name);
          await addDoc(collection(db, "receipts"), {
            packageId: selectedPackage.id,
            packageName: selectedPackage.name,
            city: selectedPackage.city,
            duration: selectedPackage.duration,
            price: selectedPackage.price,
            payerName: details.payer.name.given_name + " " + (details.payer.name.surname || ""),
            payerEmail: details.payer.email_address,
            transactionId: details.id,
            currency: details.purchase_units[0].amount.currency_code,
            date: new Date().toISOString(),
            packageImage: selectedPackage.img
          });
          document.getElementById("paymentModal").style.display = "none";
          renderPlaces();
          loadBookings();
        })
      }).render("#paypal-button");
    };

    window.closeModal = function() {
      document.getElementById("paymentModal").style.display = "none";
    };
    window.searchBookings = function() {
  const query = document.getElementById("bookingSearch").value.toLowerCase();
  const filtered = bookingsArray.filter(b => 
    (b.packageName && b.packageName.toLowerCase().includes(query)) ||
    (b.city && b.city.toLowerCase().includes(query)) ||
    (b.payerName && b.payerName.toLowerCase().includes(query))
  );
  renderBookings(filtered);
};

window.clearBookingSearch = function() {
  document.getElementById("bookingSearch").value = "";
  renderBookings(bookingsArray);
};


    // initial load
    loadPlaces();
    loadBookings();
  </script>
</head>
<body>
<header>
  <div class="logo-container">
    <img src="Images/logo.jpg" alt="Rare Explorer Logo">
    <span class="logo-text">RareExplorer Travel & Tours</span>
  </div>
  <div class="search-bar">
    <input type="text" id="search" placeholder="Search package or city..." onkeyup="searchPlaces()">
    <button class="btn btn-secondary" onclick="clearSearch()">Clear</button>
    <button class="btn btn-primary" onclick="logout()">Logout</button>
  </div>
</header>

<div class="container">
  <div class="flex-header">
    <div id="stats"></div>
    <button class="btn btn-primary" onclick="openAdd()">+ Add Package</button>
  </div>

  <!-- PACKAGES: KEPT EXACTLY AS ORIGINAL (CARD GRID) -->
  <div id="placeList" class="card-grid"></div>

  <!-- BOOKING TABLE: professional table replacing booking cards -->
<h2 style="margin-top:28px; margin-bottom:10px">Booking List</h2>
<div style="margin-bottom:10px; display:flex; gap:8px; flex-wrap:wrap;">
  <input type="text" id="bookingSearch" placeholder="Search bookings..." style="padding:8px 12px; border-radius:8px; border:none; background:#0b1220; color:white; flex:1;" onkeyup="searchBookings()">
  <button class="btn btn-secondary" onclick="clearBookingSearch()">Clear</button>
</div>
<div class="table-wrap" role="region" aria-label="Booking table">
    <table class="bookings" aria-describedby="bookingCount">
      <thead>
        <tr>
          <th style="min-width:260px">Package</th>
          <th>City</th>
          <th>Duration</th>
          <th>Price</th>
          <th>Booker</th>
          <th>Transaction & Date</th>
          <th style="width:160px; text-align:right">Actions</th>
        </tr>
      </thead>
      <tbody id="bookingsBody">
        <tr><td colspan="7" style="padding:28px 14px; text-align:center; color:#94a3b8">Loading bookings‚Ä¶</td></tr>
      </tbody>
    </table>
  </div>

  <!-- Booking list ends -->

</div>

<!-- VIEW Modal (RECEIPT / TICKET) -->
<div id="viewModal" class="modal" onclick="if(event.target.id === 'viewModal') closeViewModal()">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="viewPackageName">
    <button class="close-x" title="Close" onclick="closeViewModal()">‚úï</button>

    <div class="receipt" id="receiptContent" aria-live="polite">
      <div class="title">RareExplorer</div>

      <div class="ticket">
        <!-- LEFT: main receipt info -->
        <div class="ticket-left">
          <div class="flex-row" style="margin-bottom:8px">
            <div>
              <div class="label">Agent Details</div>
              <div id="agentName" class="value">RareExplorer Travel & Tours</div>
              <div class="small-muted">support@rareexplorer.com ¬∑ +63 912 345 6789</div>
            </div>
            <div style="text-align:right;">
              <div class="label">Issued by</div>
              <div id="issuedBy" class="value">Phili Airline</div>
              <div class="small-muted">PNR: <span id="viewTransaction" class="muted-2">-</span></div>
            </div>
          </div>

          <div class="tear-line"></div>

          <div style="margin-top:10px;">
            <div class="label">Flight Details</div>
            <div class="ticket-meta">
              <div class="meta-block">
                <div class="small-muted">Package</div>
                <div id="viewPackageName" class="value">Package Name</div>
              </div>
              <div class="meta-block">
                <div class="small-muted">Destination</div>
                <div id="viewCity" class="value">City</div>
              </div>
              <div class="meta-block">
                <div class="small-muted">Duration</div>
                <div id="viewDuration" class="value">Duration</div>
              </div>
            </div>
          </div>

          <div style="margin-top:12px;">
            <div class="label">Passenger</div>
            <div id="viewPayer" class="value">Name ¬∑ Email</div>
          </div>

          <div style="margin-top:12px;">
            <div class="label">Fare Details</div>
            <div class="flex-row" style="align-items:center; margin-top:6px;">
              <div>
                <div class="small-muted">Amount Paid</div>
                <div id="viewPrice" class="value">‚Ç±0.00</div>
              </div>
              <div style="text-align:right;">
                <div class="small-muted">Date</div>
                <div id="viewDate" class="value">-</div>
              </div>
            </div>
          </div>

          <div class="tear-line"></div>

          <div style="margin-top:8px;">
            <div class="small-muted">Notes</div>
            <div class="muted-2" style="margin-top:6px;">Please arrive 2 hours before departure. Bring a government-issued ID.</div>
          </div>
        </div>

        <!-- RIGHT: compact summary + image + barcode -->
        <div class="ticket-right">
          <div>
            <img id="viewImg" src="Images/logo.jpg" alt="Package image" class="img-thumb">
          </div>

          <div style="margin-top:12px;">
            <div class="label">Receipt Summary</div>
            <div style="margin-top:6px;">
              <div class="small-muted">Transaction</div>
              <div id="viewTransaction" class="value">-</div>
            </div>
            <div style="margin-top:8px;">
              <div class="small-muted">Passenger</div>
              <div id="viewPayer" class="value">-</div>
            </div>
            <div style="margin-top:8px;">
              <div class="small-muted">Total</div>
              <div id="viewPrice" class="value">‚Ç±0.00</div>
            </div>
          </div>

          <div>
            <div class="barcode" aria-hidden="true"></div>
            <div style="text-align:center; margin-top:8px;" class="small-muted">Barcode / Code</div>
          </div>
        </div>
      </div>

      <div class="ticket-footer">
        <div class="small-muted">Receipt ID: <span id="viewTransaction_footer" class="muted-2">-</span></div>
        <div style="display:flex; gap:8px;">
          <button class="btn btn-secondary" onclick="closeViewModal()">Close</button>
          <button class="btn btn-primary print-btn" onclick="printTicket()">Print Receipt</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Edit Modal (kept) -->
<div id="editModal" class="modal" style="display:none; align-items:center; justify-content:center;">
  <div class="modal-content">
    <h3>Edit Package</h3>
    <input type="text" id="editName" placeholder="Package Name">
    <input type="text" id="editCity" placeholder="City">
    <input type="text" id="editDuration" placeholder="Duration">
    <input type="number" id="editPrice" placeholder="Price">
    <input type="text" id="editImg" placeholder="Image URL">
    <input type="text" id="editTags" placeholder="Tags (comma separated)">
    <br><br>
    <button class="btn btn-primary" onclick="saveEdit()">Save</button>
    <button class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
  </div>
</div>

<!-- Add Modal (kept) -->
<div id="addModal" class="modal" style="display:none; align-items:center; justify-content:center;">
  <div class="modal-content">
    <h3>Add New Package</h3>
    <input type="text" id="addName" placeholder="Package Name">
    <input type="text" id="addCity" placeholder="City">
    <input type="text" id="addDuration" placeholder="Duration">
    <input type="number" id="addPrice" placeholder="Price">
    <input type="text" id="addImg" placeholder="Image URL">
    <input type="text" id="addTags" placeholder="Tags (comma separated)">
    <br><br>
    <button class="btn btn-primary" onclick="saveAdd()">Add</button>
    <button class="btn btn-secondary" onclick="closeAddModal()">Cancel</button>
  </div>
</div>

<!-- Payment Modal (kept) -->
<div id="paymentModal" class="modal" style="display:none; align-items:center; justify-content:center;">
  <div class="modal-content" style="width:520px; max-width:95%;">
    <h3>Complete Payment</h3>
    <div id="paypal-button"></div>
    <br>
    <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
  </div>
</div>

<!-- PayPal script (replace YOUR_PAYPAL_CLIENT_ID with your actual client id) -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=PHP"></script>
</body>
</html>
